services:
  - type: web
    name: imagekit
    runtime: docker
    plan: starter  # Can upgrade to 'standard', 'standard-plus', 'pro', etc.
    region: oregon  # Or: frankfurt, singapore, ohio
    branch: main
    healthCheckPath: /health  # Updated to use new observability endpoint
    
    # Auto-deploy on git push
    autoDeploy: true
    
    # Environment variables
    envVars:
      - key: RUST_LOG
        value: imagekit=info,tower_http=info
      - key: IMAGEKIT_SECRET
        generateValue: true  # Render will auto-generate a secure secret
        # Or manually set: value: your-secret-here
    
    # Persistent disk for cache (matches 10GB app limit)
    disk:
      name: imagekit-cache
      mountPath: /app/cache
      sizeGB: 10  # Matches the Sled cache max_size in config
    
    # Optional: Custom domains
    # domains:
    #   - images.yourdomain.com
